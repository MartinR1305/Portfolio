/*************************************************
 * TRANSLATIONS (FR / EN)
 *************************************************/
const translations = {
    fr: {
        /* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
           ----------------------------------------------------------------------------------- NAVIGATION -------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
        nav_about:      "À propos",
        nav_education:  "Formation",
        nav_experience: "Expérience",
        nav_games:      "Avis",
        nav_projects:   "Projets",
        nav_contact:    "Contact",

        /* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------- ABOUT ----------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
        name:           "MARTIN RECHER",
        job:            "Développeur / Ingénieur Jeux Vidéo — C++ / Unreal Engine",
        about_title:    "À propos de moi",
        about_p1:       "Passionné par le jeu vidéo depuis petit, j’ai grandi à travers de nombreux univers qui m’ont offert de superbes souvenirs et émotions, que ce soit seul ou partagées avec des ami(e)s.",
        about_p2:       "Aujourd’hui, en tant que développeur / ingénieur en jeux vidéo, mon objectif est de contribuer à la création de jeux capables de transmettre des émotions, de marquer les joueurs et de leur offrir, à leur tour, des moments mémorables à travers les projets auxquels je participe.",

        /* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
           ----------------------------------------------------------------------------------- FORMATION --------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
        education_title: "Formation",

        edu_1_title:    "Maîtrise Informatique Cheminement en Jeux Vidéo - DDJV",
        edu_1_date:     "Septembre 2024 — Mai 2025",
        edu_1_location: "Université de Sherbrooke, Longueuil, Canada",
        edu_1_desc:     "maths, c++, IA, Gameplay, outils, infographie, Unreal, intégration des médias, gestion de projet, .",
    
        edu_2_title:    "Cycle Ingénieur Informatique - Option Intelligence Artificielle",
        edu_2_date:     "Septembre 2022 — Mai 2025",
        edu_2_location: "Polytech Tours, France",
        edu_2_desc:     "Le cycle ingénieur informatique de Polytech Tours m’a permis d’acquérir des bases solides et polyvalentes dans l’ensemble de ses domaines. Cette formation m’a appris à être autonome et à m’adapter rapidement, en développant une forte capacité d’apprentissage.",

        edu_3_title:    "Parcours des Écoles d'Ingénieur Polytech - Option Mathématiques",
        edu_3_date:     "Septembre 2020 — Mai 2022",
        edu_3_location: "Polytech Clermont-Ferrand, France",
        edu_3_desc:     "Années préparatoires au parcours ingénieur Polytech, axé sur l’acquisition de bases scientifiques, avec un approfondissement en mathématiques en deuxième année.",

        edu_4_title:    "Baccalauréat Scientifique - Mention Bien",
        edu_4_date:     "Mai 2020",
        edu_4_location: "Lycée Jean-Monnet, Joué-Les-Tours, France",

        /* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
           ---------------------------------------------------------------------------------- EXPERIENCES -------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
        experience_title:   "Expériences professionnelles",
    
        exp_1_title:    "Ingénieur Développeur C++ / Unreal Engine (Stage)",
        exp_1_company:  "CORYS - Unité Transport",
        exp_1_date:     "Juillet 2025 — Janvier 2026",
        exp_1_location: "Grenoble, France",
        exp_1_desc:     "Tantum autem cuique tribuendum, primum quantum ipse efficere possis, deinde etiam quantum ille quem diligas atque adiuves, sustinere.",

        exp_2_title:    "Développeur IA & Logiciel (Stage)",
        exp_2_company:  "CHRU Tours (Hôspital)",
        exp_2_date:     "Juin 2024 — Août 2024",
        exp_2_location: "Tours, France",
        exp_2_desc:     "Tantum autem cuique tribuendum, primum quantum ipse efficere possis, deinde etiam quantum ille quem diligas atque adiuves, sustinere.",

        /* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------ PROJETS ---------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
        projects_title:     "Mes Projets",
        projects_school:    "Projets scolaires",
        projects_personal:  "Projets personnels",
        projects_view:      "Voir le projet",
    
        proj_1_title: "Projet de session d'automne - Rocket Race",
        proj_1_date: "Octobre 2024 - Décembre 2024",
        proj_1_desc: `
        <p>
            Jeu vidéo de course de voiture développé avec <strong>DirectX11</strong> et <strong>PhysX</strong> dans le cadre de la session d'automne du parcours du DDJV de l'Université de Sherbrooke.
            <br>
            Le but du jeu est d'échapper le plus longtemps possible à la tempête en parcourant la planète à travers deux différents biomes.
            <br>
            Dans ce projet j'ai pu contribué au développement de la <strong>physique</strong>, du <strong>gameplay</strong>, de <strong>l'architecture</strong> ainsi que les <strong>sons</strong> du jeu.
        <p/>  

        <p>
            Projet réalisé en équipe avec
            <a href="https://www.linkedin.com/in/fannydesjardins/"
               target="_blank"
               rel="noopener noreferrer">
                Fanny Desjardins,
            </a>
             
            <a href="https://www.linkedin.com/in/joris-casin/"
               target="_blank"
               rel="noopener noreferrer">
                Joris Casin
            </a>
            et
            <a href="https://www.linkedin.com/in/lucas-chatellier/"
               target="_blank"
               rel="noopener noreferrer">
                Lucas Chatellier.
            </a>

            <br>

            Sous la supervision et l'enseignement de
            <a href="https://www.linkedin.com/in/thomas-rouby/"
               target="_blank"
               rel="noopener noreferrer">
                Thomas Rouby
            </a>
            et 
            <a href="https://www.linkedin.com/in/jean-philip-desjardins-4834396/"
               target="_blank"
               rel="noopener noreferrer">
                Jean-Phillip Desjardins.
            </a>
        </p>
    `,
    
        proj_2_title: "Projet Personnel IA",
        proj_2_date: "2024",
        proj_2_desc: "Projet personnel explorant l’IA et les comportements avancés dans Unreal Engine.",

        /* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------- GAMES ----------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
        games_title: "Expérience joueur",
        games_favorites: "Mes jeux préférés",
        games_recent: "Jeux récents",
    
    },
    en: {
        /* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
           ----------------------------------------------------------------------------------- NAVIGATION -------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
        nav_about:      "About",
        nav_education:  "Education",
        nav_experience: "Experience",
        nav_games:      "Games",
        nav_contact:    "Contact",

        /* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------- ABOUT ----------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
        name:           "MARTIN RECHER",
        job:            "Game Developer / Engineer — C++ / Unreal Engine",
        about_title:    "About Me",
        about_p1:       "Passionate about video games from a young age, I grew up exploring many different worlds that gave me wonderful memories and strong emotions, whether experienced alone or shared with friends.",
        about_p2:       "Today, as a game developer / engineer, my goal is to contribute to the creation of games that convey emotions, leave a lasting impression on players, and in turn offer them memorable moments through the projects I take part in.",

        /* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
           ----------------------------------------------------------------------------------- FORMATION --------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
        education_title: "Education",

        edu_1_title:    "Master in Computer Science - Video Game Development",
        edu_1_date:     "September 2024 — May 2025",
        edu_1_location: "Longueuil, Canada",
        edu_1_desc:     "Tantum autem cuique tribuendum, primum quantum ipse efficere possis, deinde etiam quantum ille quem diligas atque adiuves, sustinere.",
    
        edu_2_title:    "Software Engineer - Artificial Intelligence Option",
        edu_2_date:     "September 2022 — May 2025",
        edu_2_location: "Tours, France",
        edu_2_desc:     "The computer engineering program at Polytech Tours provided me with foundations across all areas of computer science. It also helped me develop autonomy, adaptability, and a ability to learn quickly.",

        edu_3_title:    "Preparatory Engineering School Polytech - Mathematics Option",
        edu_3_date:     "September 2020 — May 2022",
        edu_3_location: "Polytech Clermont-Ferrand, France",
        edu_3_desc:     "Preparatory years for the Polytech engineering program, focused on building scientific foundations, with a specialization in mathematics during the second year.",

        edu_4_title:    "High School Diploma (Science Focus)",
        edu_4_date:     "May 2020",
        edu_4_location: "Lycée Jean-Monnet, Joué-Les-Tours, France",
        edu_4_desc:     "French scientific high school diploma focused on mathematics and sciences.",

        /* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
           ---------------------------------------------------------------------------------- EXPERIENCES -------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
        experience_title: "Professional Experience",
        nav_experience: "Experience",
    
        exp_1_title:    "Developer Engineer C++ / Unreal Engine (Internship)",
        exp_1_company:  "CORYS - Transport Unit",
        exp_1_date:     "July 2025 — January 2026",
        exp_1_location: "Grenoble, France",
        exp_1_desc:     "Tantum autem cuique tribuendum, primum quantum ipse efficere possis, deinde etiam quantum ille quem diligas atque adiuves, sustinere.",

        exp_2_title:    "AI & Software Developer (Internship)",
        exp_2_company:  "CHRU Tours (Hospital)",
        exp_2_date:     "June 2024 — August 2024",
        exp_2_location: "Tours, France",
        exp_2_desc:     "Tantum autem cuique tribuendum, primum quantum ipse efficere possis, deinde etiam quantum ille quem diligas atque adiuves, sustinere.",

        /* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------ PROJETS ---------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
        nav_projects: "Projects",
        projects_title: "My Projects",
        projects_school: "School Projects",
        projects_personal: "Personal Projects",
        projects_view: "View project",
    
        proj_1_title: "Unreal Gameplay Project",
        proj_1_date: "2023",
        proj_1_desc: "School project focused on gameplay programming in C++ using Unreal Engine.",
    
        proj_2_title: "Personal AI Project",
        proj_2_date: "2024",
        proj_2_desc: "Personal project exploring AI systems and advanced behaviors in Unreal Engine.",


        /* ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------- GAMES ----------------------------------------------------------------------------------
           ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ */
        games_title: "Ma culture vidéoludique",
        games_favorites: "Mes jeux préférés",
        games_recent: "Jeux récents",

    }
};

/*************************************************
 * LANGUAGE SWITCH
 *************************************************/
const langButtons = document.querySelectorAll(".lang-switch button");
const translatableElements = document.querySelectorAll("[data-i18n]");

function setLanguage(lang) {
    // Text only
    document.querySelectorAll("[data-i18n]").forEach(el => {
        const key = el.dataset.i18n;
        if (translations[lang][key]) {
            el.textContent = translations[lang][key];
        }
    });

    // HTML content (paragraphs, links, etc.)
    document.querySelectorAll("[data-i18n-html]").forEach(el => {
        const key = el.dataset.i18nHtml;
        if (translations[lang][key]) {
            el.innerHTML = translations[lang][key];
        }
    });

    // Active button
    document.querySelectorAll(".lang-switch button")
        .forEach(btn => btn.classList.remove("active"));
    document.querySelector(`[data-lang="${lang}"]`).classList.add("active");

    document.documentElement.lang = lang;
    localStorage.setItem("lang", lang);
}


/*************************************************
 * FADE-IN ANIMATION ON SCROLL
 *************************************************/
const fadeElements = document.querySelectorAll(".fade-in");

const observer = new IntersectionObserver(
    entries => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add("visible");
                observer.unobserve(entry.target); // perf friendly
            }
        });
    },
    { threshold: 0.2 }
);

fadeElements.forEach(el => observer.observe(el));

/*************************************************
 * EVENTS
 *************************************************/
langButtons.forEach(btn => {
    btn.addEventListener("click", () => {
        setLanguage(btn.dataset.lang);
    });
});

/*************************************************
 * INIT
 *************************************************/
const savedLang = localStorage.getItem("lang") || "fr";
setLanguage(savedLang);

/*************************************************
 * SCROLL SPY - ACTIVE NAV LINK
 *************************************************/
const sections = document.querySelectorAll("section[id]");
const navLinks = document.querySelectorAll(".top-nav a");

const sectionObserver = new IntersectionObserver(
    entries => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const id = entry.target.getAttribute("id");

                navLinks.forEach(link => {
                    link.classList.toggle(
                        "active",
                        link.getAttribute("href") === `#${id}`
                    );
                });
            }
        });
    },
    {
        rootMargin: "-40% 0px -50% 0px"
    }
);

sections.forEach(section => sectionObserver.observe(section));

/*************************************************
 * PROJECTS ACCORDION
 *************************************************/
const projectCards = document.querySelectorAll(".project-card");

projectCards.forEach(card => {
    const button = card.querySelector(".project-toggle");

    button.addEventListener("click", () => {
        const isOpen = card.classList.contains("open");

        projectCards.forEach(c => c.classList.remove("open"));

        if (!isOpen) {
            card.classList.add("open");
        }
    });
});

/*************************************************
 * PROJECT MEDIA CAROUSEL + DOTS
 *************************************************/
document.querySelectorAll(".project-card").forEach(card => {
    const mediaItems = card.querySelectorAll(".media-item");
    const prevBtn = card.querySelector(".media-btn.prev");
    const nextBtn = card.querySelector(".media-btn.next");
    const dotsContainer = card.querySelector(".media-dots");

    if (mediaItems.length === 0 || !prevBtn || !nextBtn || !dotsContainer) return;

    let index = 0;
    const dots = [];

    // Create dots
    mediaItems.forEach((_, i) => {
        const dot = document.createElement("div");
        dot.classList.add("media-dot");
        if (i === 0) dot.classList.add("active");

        dot.addEventListener("click", () => {
            index = i;
            showMedia(index);
        });

        dotsContainer.appendChild(dot);
        dots.push(dot);
    });

    function showMedia(i) {
        mediaItems.forEach(item => {
            // Reset YouTube iframe if present
            if (item.classList.contains("youtube")) {
                const iframe = item.querySelector("iframe");
                iframe.src = iframe.src;
            }
            item.classList.remove("active");
        });

        dots.forEach(d => d.classList.remove("active"));

        mediaItems[i].classList.add("active");
        dots[i].classList.add("active");
    }

    prevBtn.addEventListener("click", () => {
        index = (index - 1 + mediaItems.length) % mediaItems.length;
        showMedia(index);
    });

    nextBtn.addEventListener("click", () => {
        index = (index + mediaItems.length + 1) % mediaItems.length;
        showMedia(index);
    });
});

/*************************************************
 * RECENTS GAMES
 *************************************************/

document.querySelectorAll(".recent-game").forEach(game => {
    const btn = game.querySelector(".recent-toggle");

    btn.addEventListener("click", () => {
        const open = game.classList.contains("open");
        document.querySelectorAll(".recent-game")
            .forEach(g => g.classList.remove("open"));
        if (!open) game.classList.add("open");
    });
});

document.querySelectorAll('a[href="#contact"]').forEach(link => {
  link.addEventListener("click", e => {
    e.preventDefault();
    document.querySelector("#contact").scrollIntoView({
      behavior: "smooth"
    });
  });
});

const scrollTopBtn = document.querySelector(".scroll-top");

window.addEventListener("scroll", () => {
    if (window.scrollY > 400) {
        scrollTopBtn.classList.add("visible");
    } else {
        scrollTopBtn.classList.remove("visible");
    }
});

scrollTopBtn.addEventListener("click", () => {
    window.scrollTo({
        top: 0,
        behavior: "smooth"
    });
});
